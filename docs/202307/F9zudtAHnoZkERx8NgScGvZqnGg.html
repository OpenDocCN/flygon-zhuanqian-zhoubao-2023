<h1>《影刀RPA 0基础新手如何一天抓取500本孔夫子二手书ISBN的方法》</h1>
<blockquote>来源：<a href="https://ngppuxr565.feishu.cn/docx/F9zudtAHnoZkERx8NgScGvZqnGg">https://ngppuxr565.feishu.cn/docx/F9zudtAHnoZkERx8NgScGvZqnGg</a></blockquote>

<h3>介绍</h3>
<p>大家好呀，这里是生财新圈友，一名程序员，目前在小红书和闲鱼上探索新的可能性，包括项目的闭环放大、工具类开发。</p>
<p>我们都知道，每个项目或多或少都需要我们去做一些重复性的操作，如做中医号剪视频时常用到的视频批量混剪工具，小红书平台的后羿采集器。一个恰到好处的工具能够解放我们的双手，帮我们省下重复性工作的时间，有更多时间去思考、选品、生活。</p>

<p>在我第一次打算使用抖音去水印工具，拿到同行作品原图时，从上到下看了下真的一点抖音水印都没有的时候，觉得太神奇了，那一刻我真的觉得这个工具真的泰裤辣！</p>

<p>每个人都有自己的赛道定位，大部分工具(视频混剪、后羿采集器)可以解决我们的90%的通用性重复性工作问题，那剩下的10%的非通用性问题怎么办？</p>
<p>举个栗子：</p>
<p>在这次的闲鱼二手书航海行动中，得益于华少开发的闲管家工具，实现了以下功能：</p>
<p>搞定上书（累）</p>
<p>搞定订单（乱）</p>
<p>搞定客户咨询（烦）</p>
<p><img src="img/509d8422410730030a9a5d7c65a14bb9.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/NFZabnYgros0nAxLeoUcrhBLnpg/"/></p>

<p>有此神器在手，节省了非常多的时间，我们可以把所有的精力放在选品上。殊知时间就是生命。</p>
<p>一个好用的工具的重要性可想而知！</p>

<p>但是在此过程中，每个人的赛道不一样，有的人聚焦小说类，有的人聚焦绘本，而有的人聚焦教材类。赛道多样化，需求多样性，赛道和需求的不可预期性，做出一个通用的工具可能性大大降低。投入产出比非常低。掌握了影刀工具，在个性化需求中也能快速解决，提高成产力，节省时间！</p>

<p>举个例子，在本次二手书上架过程中，需要我们手动找到详情页上的ISBN号，圈友是做大学教材类的，因而要针对大学教材页面去过滤出想要上架的书本，接着一个个点进去详情页查看ISBN号和定价参考。量大之后就会出现如下场景:</p>

<p><img src="img/1ce5644b9891278959b9a402e48eb495.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/PVrCb2eyNoQCDUx0as7cYc22nAe/"/></p>

<p>在提出需求的那一刻，没有人比你更懂重复性工作的枯燥，没有人比你更想摆脱这种重复性工作的痛苦</p>
<p>怎么解决？</p>

<p>GPT可以充当大脑，</p>
<p>RPA可以充当手脚！</p>
<p>授人与鱼，不如授人与渔！</p>

<p>用影刀RPA，仅仅十来个代码逻辑便可解决这个工具，不用学习众多的语法，复杂的格式！就可以解决在任何平台中遇到的重复性工作问题。</p>

<p>不仅仅是闲鱼，回顾下小红书、抖音等平台上还有什么可以解放双手的重复性工作？</p>
<p>蝉小红工具中，专业版用户无法导出品类排序表格，我们还有什么办法？影刀抓取！</p>
<p><img src="img/b1e4b0ad6973d8e77e7edfa9b01c3507.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/PILKbuwRYoQ6t9xMQePcMIq5nne/"/></p>
<p>这是不仅是一篇工具分享文，还是一篇技术教学文，带领小白上手影刀自动化工具，让我们在成为超级个体的路上更进一步！</p>

<p>用了的小伙伴都说嘎嘎好，在短时间可以直接铺多个号！</p>

<p><img src="img/2b8d2eefff5855d6ecec92e015093ec0.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Nqn5bHOCCoMZoyxyFvJcheafnec/"/></p>

<p>废话不多说，先看成品：</p>
<h3>2. 结果及资源获取：</h3>
<h4>2.1 成果</h4>
<p>爬下来的效果如下图，这样可以简单获取ISBN号、书名以及定价信息去上架了。截图仅呈现10条</p>
<p><img src="img/f7b8e53b188d0cb60d2ec5ac29a7f8f4.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/AV6gb4aNVoUZpjxlUkocSq0Knob/"/></p>

<h4>2.2 视频版教程：</h4>
<p>https://www.bilibili.com/video/BV1mc411M7n7/?vd_source=1ff29a067cb6004944b37448caaa54a1</p>
<p><img src="img/52185622f6cf552b70de45df1d263c3e.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Udrnb04MvocDBPxbIiFcwBRknqg/"/></p>
<h4>2.3 应用下载链接</h4>
<p>下载链接: https://api.winrobot360.com/redirect/robot/share?inviteKey=47a8b68841cd6795</p>
<p>打开方式:下载后用影刀打开即可</p>

<p><img src="img/6527f21328862b316cac3fdea34296c2.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/MaGQbfs6FoMxm5x5vjqcd6WVnLf/"/></p>
<h3>实现流程分析</h3>
<h4>3.1需求分析</h4>
<p>在得到初步的需求后，我们需要进行需求拆解分析：</p>
<p>主需求：从孔夫子网获取ISBN和价格</p>
<p>工具：影刀</p>
<p>流程：</p>


<p><img src="img/7a7eddf04f54dd923832dc2984989d3f.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/EkRgbH2z9oryYBxfpgCcGzCEnph/"/></p>
<p><img src="img/0b7a3fcdf21a7d254ab46530f1409385.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Izx4b4QXlohPBAxyrOjcfgJdnId/"/></p>
<table><tr><th/><th/></tr><tr><td/><td/></tr></table>

<p>获取单一书本流程                                                循环获取书本流程</p>
<hr/>



<h4>3.2 影刀熟悉</h4>
<p>有了初步的构思后，接着分析尝试下:熟悉影刀平台。首先在B站上粗略看了下影刀的官方介绍及第一个demo实例：</p>


<p><img src="img/a958c08f06ccf36293c44c511e2020c1.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/WDgeblQVlolrfgxnHPxcbSKdnag/"/></p>

<p>B站教程链接：    https://www.bilibili.com/video/BV1734y1j7iJ/?spm_id_from=333.337.search-card.all.click&amp;vd_source=1ff29a067cb6004944b37448caaa54a1</p>

<h4>3.3 流程解析如下：</h4>
<ol><li>打开孔夫子网站，获取这一列都要点击的书名。</li></ol>
<ol><li>跳转到所选的书目详情页，开始点击每一步书，获取title、ISBN、定价，</li></ol>
<ol><li>保存到数据表格中。</li></ol>

<p>流程操作：</p>
<p><img src="img/213acbd050369090b733bcea89410722.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/PWb0b0UcxoCwF3xehWoc3FJqnjz/"/></p>
<p><img src="img/256ccdf5cf1b0228454d278fd674bab1.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/R0xOb8nGZoWkiex5pfBcOk8rnEe/"/></p>
<p><img src="img/31ba899299e5d0da04772200b05d55c7.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/AcxnbPD8eoM7JtxptVpcnHdzncc/"/></p>


<h3>4.代码实现拆解</h3>
<table><tr><th>序号</th><th>功能</th><th>描述</th></tr><tr><td>1</td><td>打开网页</td><td>打开孔夫子大学教材栏目网站</td></tr><tr><td>2</td><td>点击元素</td><td>点击高等数学，会跳出一个新的标签页</td></tr><tr><td>3</td><td>获取网页对象</td><td>获取当前所有打开的标签页</td></tr><tr><td>4</td><td>设置变量</td><td>设置最后一个标签页的名字为高等数学详情页</td></tr><tr><td>5</td><td>等待网页加载完成</td><td>等待高等数学详情页加载完成</td></tr><tr><td>6</td><td>获取元素信息</td><td>获取书名、ISBN、定价</td></tr><tr><td>7</td><td>写入数据表格</td><td>写入表格</td></tr></table>
<h4>4.1 初版代码编写</h4>

<p><img src="img/f5bba45c050a2236b60b8742f7b07c61.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/Xx0fbqz3QoEN7ZxeBp6cq98hnwf/"/></p>


<p>结果如下：</p>
<p><img src="img/002922915edccd5ce4e4fd0ecadc596f.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/IS8lbwVfLomay0x4NaYcvr5wnof/"/></p>
<h4>4.2 功能完善</h4>
<p>1.加入每一行的循环元素，循环抓取当前页列表的每一本书</p>

<p><img src="img/1f5e5e33e99fe5cd0d61dfd98fdf15f7.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/ZEIxbDB31o8eVjxy7VZcr2Fdn5e/"/></p>

<p>2.最后加入每一页的循环元素，从第一页轮询到最后一页，循环抓取</p>
<p><img src="img/46fc912c2dd6b1ad11e2da761527f6bd.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/UhnzbSygJoFraoxY8upcaVEFnwb/"/></p>

<h4>4.3 完整代码</h4>
<p><img src="img/b8e29f2ded3b7543666482e8e0c12472.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/UCjobmpEsoMUOtxGJcRcz0OKnjf/"/></p>
<p><img src="img/ffdf61a6fc74eede76a38179e721ec9c.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/OqQrb04LfomLaaxZuPacqJPFn3g/"/></p>
<h3>5.注意事项</h3>
<h4>5.1 bug排查</h4>

<p>在开发调试过程中可能会遇到如下问题，其可参考的解决方案如下：</p>
<p>问题1：   每本书详情页的数据排版不相同，直接抓取ISBN和定价可能会抓取失败</p>
<p>解决方案：直接抓取整个详情页区块的数据，再对数据用正则表达式的形式进行筛选过滤出ISBN和定价的字段</p>
<p>公式：    ISBN:(.*)代表匹配含有ISBN:的字符串，并输出：后面的数据</p>
<p>举例：     输入：”ISBN:123456789”  输出：”123456789”</p>
<p><img src="img/a7b2d0bcd8a48c7d90e1d237629517bf.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/GxHHbIWujo4j2FxISvdcUZXInaf/"/></p>

<p>问题2：   在抓取标题时出现抓取失败，获取不到字段</p>
<p>解决方案：1.可能是标签页选错，没有选择跳转后的新标签页，选择好正确的标签页即可</p>
<p>2.可能是网络较差，在网页数据还没刷新时就去获取字段，将等待元素存在由默认20s改为50s或者其他合适的值</p>
<p><img src="img/4e261cafafd3fbde9bea84397b1bddcd.png" data-original-src="https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/v2/cover/PAs9bVH2Jo8dQBxWAVUcbMgGnef/"/></p>
<h3>6.小结</h3>
<p>到这整个流程就结束了。入门编写代码总会遇到奇奇怪怪的问题，尽量先抄成功案例，一步一步跟着走，跑起来一个自己写的程序后会有很强的成就感，再去优化流程，编写自己想要的逻辑。</p>

<p>大家如果有什么需要，也欢迎和我交流。</p>
